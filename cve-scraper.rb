#!/usr/bin/env ruby

require 'nokogiri'
require 'net/http'
require 'uri'

keyword = ARGV[0] # Yes yes security whatever not for production etc.

if keyword && keyword.strip
  puts "Fetching CVEs related to #{keyword}"
else
  puts "You need a keyword. Try your favorite company."
  exit(1)
end

uri = URI.parse("https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=#{keyword}")
res = Net::HTTP.get_response(uri)

doc = Nokogiri.HTML(res.body)

cve_table = doc.search('table')[2].search('tr')

cve_table.each do |line|
  cve = line.search('td').first
  next unless cve
  puts cve.text.strip
end



